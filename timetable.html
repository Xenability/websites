<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Planner Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Source+Sans+3:wght@400;500;600&family=VT323&family=Orbitron:wght@400;700&family=Courier+Prime:wght@400;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #faf9f7;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f0ede8;
            --text-primary: #1a1a2e;
            --text-secondary: #4a4a5a;
            --text-muted: #8a8a9a;
            --accent: #c9a227;
            --accent-rgb: 201, 162, 39;
            --accent-light: rgba(201, 162, 39, 0.15);
            --accent-hover: #b8912a;
            --border: #e8e5de;
            --shadow: rgba(26, 26, 46, 0.08);
            --font-main: 'Source Sans 3', sans-serif;
            --font-heading: 'Playfair Display', serif;
            --radius: 12px;
            --q1: #e74c3c;
            --q2: #3498db;
            --q3: #f39c12;
            --q4: #95a5a6;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        /* Dark Mode */
        .dark {
            --bg-primary: #13111a;
            --bg-secondary: #1e1b28;
            --bg-tertiary: #2a2635;
            --text-primary: #f5f4f0;
            --text-secondary: #c5c4c0;
            --text-muted: #7a7980;
            --accent-light: rgba(var(--accent-rgb), 0.2);
            --border: #3a3645;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        /* ========== CREATIVE THEMES ========== */

        /* Cyberpunk */
        .theme-cyberpunk {
            --bg-primary: #0a0a12;
            --bg-secondary: #12121f;
            --bg-tertiary: #1a1a2e;
            --text-primary: #00fff9;
            --text-secondary: #ff00ff;
            --text-muted: #666699;
            --accent: #ff00ff;
            --accent-rgb: 255, 0, 255;
            --accent-light: rgba(255, 0, 255, 0.2);
            --accent-hover: #cc00cc;
            --border: #333366;
            --font-main: 'Orbitron', sans-serif;
            --font-heading: 'Orbitron', sans-serif;
            --radius: 4px;
        }
        .theme-cyberpunk::before {
            content: '';
            position: fixed;
            inset: 0;
            background:
                linear-gradient(90deg, transparent 98%, rgba(255,0,255,0.03) 100%),
                linear-gradient(transparent 98%, rgba(0,255,249,0.03) 100%);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 9999;
        }

        /* 90s Retro */
        .theme-90s {
            --bg-primary: #ffeb3b;
            --bg-secondary: #ff5722;
            --bg-tertiary: #e91e63;
            --text-primary: #1a1a1a;
            --text-secondary: #333333;
            --text-muted: #555555;
            --accent: #00bcd4;
            --accent-rgb: 0, 188, 212;
            --accent-light: rgba(0, 188, 212, 0.3);
            --accent-hover: #0097a7;
            --border: #ff9800;
            --font-main: 'VT323', monospace;
            --font-heading: 'VT323', monospace;
            --radius: 0px;
        }
        .theme-90s.dark {
            --bg-primary: #1a1a2e;
            --bg-secondary: #2d1b4e;
            --bg-tertiary: #4a1942;
            --text-primary: #ffeb3b;
            --text-secondary: #ff5722;
            --border: #9c27b0;
        }

        /* Vintage Paper */
        .theme-vintage {
            --bg-primary: #f4e4bc;
            --bg-secondary: #fffef5;
            --bg-tertiary: #e8d5a3;
            --text-primary: #2c1810;
            --text-secondary: #5c4033;
            --text-muted: #8b7355;
            --accent: #8b4513;
            --accent-rgb: 139, 69, 19;
            --accent-light: rgba(139, 69, 19, 0.15);
            --accent-hover: #6b3410;
            --border: #c4a35a;
            --font-main: 'Courier Prime', monospace;
            --font-heading: 'Playfair Display', serif;
            --radius: 2px;
        }
        .theme-vintage.dark {
            --bg-primary: #1a1510;
            --bg-secondary: #2a2015;
            --bg-tertiary: #3a2a1a;
            --text-primary: #e8d5a3;
            --text-secondary: #c4a35a;
            --border: #5c4033;
        }

        /* Neon Night */
        .theme-neon {
            --bg-primary: #0d0d0d;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #262626;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #888888;
            --accent: #39ff14;
            --accent-rgb: 57, 255, 20;
            --accent-light: rgba(57, 255, 20, 0.2);
            --accent-hover: #32e012;
            --border: #333333;
            --font-main: 'Space Mono', monospace;
            --font-heading: 'Space Mono', monospace;
            --radius: 8px;
        }

        /* Ocean Depths */
        .theme-ocean {
            --bg-primary: #e0f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #b2ebf2;
            --text-primary: #004d40;
            --text-secondary: #00695c;
            --text-muted: #4db6ac;
            --accent: #00838f;
            --accent-rgb: 0, 131, 143;
            --accent-light: rgba(0, 131, 143, 0.15);
            --accent-hover: #006064;
            --border: #80deea;
            --radius: 16px;
        }
        .theme-ocean.dark {
            --bg-primary: #0a1929;
            --bg-secondary: #0d2137;
            --bg-tertiary: #132f4c;
            --text-primary: #b2ebf2;
            --text-secondary: #80deea;
            --border: #1e4976;
        }

        /* Sunset */
        .theme-sunset {
            --bg-primary: #fff5f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #ffe4e1;
            --text-primary: #4a1c1c;
            --text-secondary: #7c3030;
            --text-muted: #b05050;
            --accent: #ff6b6b;
            --accent-rgb: 255, 107, 107;
            --accent-light: rgba(255, 107, 107, 0.15);
            --accent-hover: #ee5a5a;
            --border: #ffc1c1;
            --radius: 20px;
        }
        .theme-sunset.dark {
            --bg-primary: #1a0a0a;
            --bg-secondary: #2a1515;
            --bg-tertiary: #3a2020;
            --text-primary: #ffb4b4;
            --text-secondary: #ff8a8a;
            --border: #4a2525;
        }

        /* Forest */
        .theme-forest {
            --bg-primary: #f1f8e9;
            --bg-secondary: #ffffff;
            --bg-tertiary: #dcedc8;
            --text-primary: #1b3d1b;
            --text-secondary: #2e5a2e;
            --text-muted: #6b9b6b;
            --accent: #4caf50;
            --accent-rgb: 76, 175, 80;
            --accent-light: rgba(76, 175, 80, 0.15);
            --accent-hover: #43a047;
            --border: #a5d6a7;
            --radius: 12px;
        }
        .theme-forest.dark {
            --bg-primary: #0a150a;
            --bg-secondary: #152015;
            --bg-tertiary: #1f301f;
            --text-primary: #c8e6c9;
            --text-secondary: #a5d6a7;
            --border: #2e4a2e;
        }

        /* Lavender Dream */
        .theme-lavender {
            --bg-primary: #f3e5f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e1bee7;
            --text-primary: #311b3d;
            --text-secondary: #5c3670;
            --text-muted: #9c6aad;
            --accent: #9c27b0;
            --accent-rgb: 156, 39, 176;
            --accent-light: rgba(156, 39, 176, 0.15);
            --accent-hover: #7b1fa2;
            --border: #ce93d8;
            --radius: 24px;
        }
        .theme-lavender.dark {
            --bg-primary: #1a0a1f;
            --bg-secondary: #2a152f;
            --bg-tertiary: #3a1f40;
            --text-primary: #e1bee7;
            --text-secondary: #ce93d8;
            --border: #4a2555;
        }

        /* Minimal */
        .theme-minimal {
            --bg-primary: #fafafa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f0f0f0;
            --text-primary: #111111;
            --text-secondary: #444444;
            --text-muted: #888888;
            --accent: #111111;
            --accent-rgb: 17, 17, 17;
            --accent-light: rgba(17, 17, 17, 0.08);
            --accent-hover: #333333;
            --border: #e0e0e0;
            --radius: 6px;
        }
        .theme-minimal.dark {
            --bg-primary: #111111;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #222222;
            --text-primary: #fafafa;
            --text-secondary: #cccccc;
            --accent: #fafafa;
            --accent-light: rgba(250, 250, 250, 0.1);
            --border: #333333;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-main);
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            transition: all 0.3s;
            font-size: 14px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 12px;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent), var(--accent-hover));
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            box-shadow: 0 4px 15px rgba(var(--accent-rgb), 0.3);
        }

        h1 {
            font-family: var(--font-heading);
            font-size: 1.4rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-actions {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 8px 12px;
            border: none;
            border-radius: var(--radius);
            font-family: var(--font-main);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
            box-shadow: 0 2px 8px rgba(var(--accent-rgb), 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(var(--accent-rgb), 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-icon {
            width: 34px;
            height: 34px;
            padding: 0;
            justify-content: center;
        }

        .btn-sm {
            padding: 5px 8px;
            font-size: 11px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 3px;
            margin-bottom: 12px;
            background: var(--bg-secondary);
            padding: 4px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            min-width: 70px;
            padding: 8px 12px;
            border: none;
            border-radius: calc(var(--radius) - 2px);
            background: transparent;
            color: var(--text-secondary);
            font-family: var(--font-main);
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .tab:hover { background: var(--bg-tertiary); }
        .tab.active { background: var(--accent); color: white; }
        .tab-content { display: none; animation: fadeUp 0.3s ease-out; }
        .tab-content.active { display: block; }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 12px;
        }

        @media (max-width: 1000px) {
            .main-grid { grid-template-columns: 1fr; }
        }

        /* Week Nav */
        .week-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 10px 14px;
            background: var(--bg-secondary);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 8px;
        }

        .week-nav h2 {
            font-family: var(--font-heading);
            font-size: 1rem;
        }

        .nav-btns { display: flex; gap: 5px; }

        /* Timetable */
        .timetable-wrapper {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .timetable {
            display: grid;
            grid-template-columns: 50px repeat(7, 1fr);
            min-width: 550px;
        }

        .timetable-scroll { overflow-x: auto; }

        .day-header {
            padding: 10px 4px;
            text-align: center;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
            font-weight: 600;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
        }

        .day-header.today {
            background: var(--accent);
            color: white;
        }

        .day-header .day-date {
            display: block;
            font-size: 9px;
            font-weight: 400;
            margin-top: 2px;
            opacity: 0.8;
        }

        .time-slot {
            padding: 4px;
            font-size: 9px;
            font-weight: 500;
            color: var(--text-muted);
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
            border-right: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slot-cell {
            min-height: 44px;
            padding: 3px;
            border-bottom: 1px solid var(--border);
            border-right: 1px solid var(--border);
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }

        .slot-cell:hover { background: var(--accent-light); }
        .slot-cell:last-child { border-right: none; }

        .slot-cell.has-content {
            background: var(--accent-light);
        }

        .slot-cell.has-content::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--accent);
        }

        .slot-text {
            font-size: 10px;
            color: var(--text-primary);
            word-break: break-word;
            line-height: 1.2;
            padding: 2px;
        }

        .slot-cell .edit-hint {
            display: none;
            position: absolute;
            inset: 0;
            background: var(--accent-light);
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: var(--accent);
        }

        .slot-cell:hover .edit-hint { display: flex; }

        /* Slot Editor Modal */
        .slot-editor-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: flex-end;
            justify-content: center;
        }

        .slot-editor-modal.active { display: flex; }

        .slot-editor {
            background: var(--bg-secondary);
            width: 100%;
            max-width: 480px;
            border-radius: var(--radius) var(--radius) 0 0;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .slot-editor-header {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .slot-editor-header h3 {
            font-family: var(--font-heading);
            font-size: 1rem;
        }

        .slot-editor-info {
            display: flex;
            gap: 6px;
            font-size: 12px;
            margin-top: 4px;
        }

        .slot-editor-info span {
            background: var(--accent-light);
            color: var(--accent);
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: 500;
        }

        .slot-editor-body { padding: 16px; }

        .slot-editor textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-family: var(--font-main);
            font-size: 16px;
            background: var(--bg-primary);
            color: var(--text-primary);
            resize: none;
        }

        .slot-editor textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .slot-editor-footer {
            padding: 12px 16px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 8px;
        }

        .slot-editor-footer .btn {
            flex: 1;
            padding: 12px;
            font-size: 14px;
        }

        /* Panels */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .panel {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }

        .panel-header h3 {
            font-family: var(--font-heading);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .panel-header h3 i { color: var(--accent); }
        .panel-body { padding: 10px; }

        /* Tasks */
        .task-input-wrapper {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }

        .task-input, .habit-input, .note-input, .goal-input {
            flex: 1;
            padding: 9px 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-family: var(--font-main);
            font-size: 13px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .task-input:focus, .habit-input:focus, .note-input:focus, .goal-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-light);
        }

        .task-options {
            display: flex;
            gap: 5px;
            margin-bottom: 8px;
        }

        .task-options select {
            flex: 1;
            padding: 6px 8px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-family: var(--font-main);
            font-size: 11px;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .task-list, .goal-list {
            list-style: none;
            max-height: 250px;
            overflow-y: auto;
        }

        .task-item, .goal-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            padding: 8px;
            margin-bottom: 5px;
            background: var(--bg-primary);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            transition: all 0.2s;
        }

        .task-item:hover, .goal-item:hover { border-color: var(--accent); }

        .task-number {
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--accent);
            color: white;
            font-size: 10px;
            font-weight: 600;
            border-radius: 5px;
        }

        .task-content, .goal-content { flex: 1; min-width: 0; }

        .task-text, .goal-text {
            font-size: 12px;
            color: var(--text-primary);
            margin-bottom: 3px;
            word-break: break-word;
        }

        .task-meta { display: flex; gap: 3px; flex-wrap: wrap; }

        .task-badge {
            padding: 2px 5px;
            font-size: 9px;
            font-weight: 500;
            border-radius: 3px;
            text-transform: uppercase;
        }

        .priority-high { background: rgba(231, 76, 60, 0.15); color: var(--danger); }
        .priority-medium { background: rgba(243, 156, 18, 0.15); color: var(--warning); }
        .priority-low { background: rgba(39, 174, 96, 0.15); color: var(--success); }

        .task-actions, .goal-actions { display: flex; gap: 2px; }

        .task-btn {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            border-radius: 5px;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 11px;
        }

        .task-btn:hover { background: var(--bg-tertiary); color: var(--text-primary); }
        .task-btn.complete:hover { color: var(--success); }
        .task-btn.delete:hover { color: var(--danger); }

        .task-item.completed .task-text,
        .goal-item.completed .goal-text {
            text-decoration: line-through;
            color: var(--text-muted);
        }

        .task-item.completed .task-number { background: var(--success); }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 28px;
            margin-bottom: 8px;
            color: var(--border);
        }

        .empty-state p { font-size: 12px; }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }

        .stat-card {
            padding: 10px;
            background: var(--bg-primary);
            border-radius: var(--radius);
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-value {
            font-family: var(--font-heading);
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent);
        }

        .stat-label {
            font-size: 9px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .progress-wrapper { margin-top: 10px; }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            margin-bottom: 5px;
        }

        .progress-bar {
            height: 6px;
            background: var(--bg-primary);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--accent-hover));
            border-radius: 3px;
            transition: width 0.5s;
        }

        /* Pomodoro Timer */
        .pomodoro-container {
            text-align: center;
            padding: 16px;
        }

        .pomodoro-display {
            font-family: var(--font-heading);
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(var(--accent-rgb), 0.3);
        }

        .pomodoro-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .pomodoro-controls {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .pomodoro-presets {
            display: flex;
            justify-content: center;
            gap: 6px;
            flex-wrap: wrap;
        }

        .preset-btn {
            padding: 5px 10px;
            font-size: 10px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--text-secondary);
            cursor: pointer;
        }

        .preset-btn:hover, .preset-btn.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        /* Habits */
        .habits-grid { display: grid; gap: 8px; }

        .habit-row {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            background: var(--bg-primary);
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .habit-icon {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-size: 12px;
        }

        .habit-icon.study { background: rgba(52, 152, 219, 0.15); color: #3498db; }
        .habit-icon.exercise { background: rgba(39, 174, 96, 0.15); color: var(--success); }
        .habit-icon.homework { background: rgba(155, 89, 182, 0.15); color: #9b59b6; }
        .habit-icon.leisure { background: rgba(243, 156, 18, 0.15); color: var(--warning); }
        .habit-icon.custom { background: var(--accent-light); color: var(--accent); }

        .habit-info { flex: 1; }
        .habit-name { font-size: 12px; font-weight: 500; }
        .habit-target { font-size: 10px; color: var(--text-muted); }

        .habit-days { display: flex; gap: 2px; }

        .habit-day {
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-size: 8px;
            font-weight: 600;
            background: var(--bg-tertiary);
            color: var(--text-muted);
            cursor: pointer;
            border: none;
        }

        .habit-day:hover { background: var(--accent-light); }
        .habit-day.done { background: var(--success); color: white; }

        .add-habit-form {
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding: 10px;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            margin-bottom: 10px;
        }

        .add-habit-form input, .add-habit-form select {
            padding: 8px 10px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-family: var(--font-main);
            font-size: 13px;
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .add-habit-row { display: flex; gap: 6px; }
        .add-habit-row input { flex: 1; }

        /* Balance */
        .balance-section {
            margin-top: 12px;
            padding: 10px;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
        }

        .balance-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .balance-labels {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            margin-bottom: 5px;
        }

        .balance-labels .work { color: #3498db; }
        .balance-labels .play { color: var(--warning); }

        .balance-bar {
            height: 10px;
            background: var(--bg-primary);
            border-radius: 5px;
            overflow: hidden;
            display: flex;
        }

        .balance-work { background: linear-gradient(90deg, #3498db, #5dade2); }
        .balance-play { background: linear-gradient(90deg, #f5b041, var(--warning)); }
        .balance-neutral { flex: 1; background: var(--bg-tertiary); }

        .balance-message {
            text-align: center;
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 6px;
        }

        /* Matrix */
        .matrix-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 12px;
        }

        .matrix-labels {
            grid-column: 1 / -1;
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 6px;
        }

        .matrix-label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .matrix-quadrant {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            border: 2px solid var(--border);
            min-height: 180px;
            display: flex;
            flex-direction: column;
        }

        .quadrant-header {
            padding: 8px 10px;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .q1 .quadrant-header { background: rgba(231, 76, 60, 0.15); color: var(--q1); }
        .q2 .quadrant-header { background: rgba(52, 152, 219, 0.15); color: var(--q2); }
        .q3 .quadrant-header { background: rgba(243, 156, 18, 0.15); color: var(--q3); }
        .q4 .quadrant-header { background: rgba(149, 165, 166, 0.15); color: var(--q4); }

        .quadrant-body {
            flex: 1;
            padding: 8px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .quadrant-input-wrapper { display: flex; gap: 4px; }

        .quadrant-input {
            flex: 1;
            padding: 6px 8px;
            border: 1px dashed var(--border);
            border-radius: var(--radius);
            font-family: var(--font-main);
            font-size: 12px;
            background: transparent;
            color: var(--text-primary);
        }

        .quadrant-input:focus {
            outline: none;
            border-style: solid;
            border-color: var(--accent);
        }

        .quadrant-items { flex: 1; overflow-y: auto; max-height: 120px; }

        .quadrant-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 8px;
            background: var(--bg-primary);
            border-radius: var(--radius);
            margin-bottom: 4px;
            font-size: 11px;
        }

        .quadrant-item .item-text { flex: 1; word-break: break-word; }
        .quadrant-item.completed .item-text { text-decoration: line-through; color: var(--text-muted); }

        /* Notes */
        .notes-area {
            width: 100%;
            min-height: 150px;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-family: var(--font-main);
            font-size: 13px;
            background: var(--bg-primary);
            color: var(--text-primary);
            resize: vertical;
        }

        .notes-area:focus {
            outline: none;
            border-color: var(--accent);
        }

        /* Quotes */
        .quote-card {
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-light), transparent);
            border-radius: var(--radius);
            border-left: 4px solid var(--accent);
            margin-bottom: 12px;
        }

        .quote-text {
            font-size: 13px;
            font-style: italic;
            color: var(--text-primary);
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .quote-author {
            font-size: 11px;
            color: var(--text-muted);
            text-align: right;
        }

        .quote-refresh {
            margin-top: 10px;
            text-align: center;
        }

        /* Theme Panel */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .theme-card {
            padding: 12px 8px;
            border-radius: var(--radius);
            border: 2px solid var(--border);
            background: var(--bg-primary);
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .theme-card:hover { border-color: var(--accent); transform: translateY(-2px); }
        .theme-card.active { border-color: var(--accent); box-shadow: 0 4px 12px rgba(var(--accent-rgb), 0.3); }

        .theme-preview {
            width: 100%;
            height: 30px;
            border-radius: 6px;
            margin-bottom: 6px;
        }

        .theme-name { font-size: 10px; font-weight: 600; color: var(--text-primary); }

        /* Color Mixer */
        .color-mixer {
            padding: 12px;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            margin-top: 12px;
        }

        .color-mixer-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .color-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .color-row label {
            font-size: 11px;
            min-width: 80px;
            color: var(--text-secondary);
        }

        .color-picker {
            width: 40px;
            height: 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: transparent;
        }

        .color-picker::-webkit-color-swatch-wrapper { padding: 0; }
        .color-picker::-webkit-color-swatch { border-radius: 6px; border: 2px solid var(--border); }

        .intensity-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            border-radius: 3px;
            background: var(--bg-primary);
        }

        .intensity-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        .modal-overlay.active { display: flex; }

        .modal {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            max-width: 380px;
            width: 100%;
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 16px;
            border-bottom: 1px solid var(--border);
        }

        .modal-header h3 { font-family: var(--font-heading); font-size: 1rem; }
        .modal-body { padding: 16px; }
        .modal-body p { color: var(--text-secondary); font-size: 13px; }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            padding: 12px 16px;
            border-top: 1px solid var(--border);
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent);
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(var(--accent-rgb), 0.4);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .fab:hover { transform: scale(1.1); }

        .fab-menu {
            position: fixed;
            bottom: 80px;
            right: 20px;
            display: none;
            flex-direction: column;
            gap: 8px;
            z-index: 99;
        }

        .fab-menu.active { display: flex; }

        .fab-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 12px;
            color: var(--text-primary);
            cursor: pointer;
            box-shadow: 0 2px 10px var(--shadow);
            animation: slideIn 0.2s ease-out;
        }

        .fab-item:hover { background: var(--accent); color: white; }

        /* Streak Counter */
        .streak-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: var(--bg-primary); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

        .file-input { display: none; }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 8px; }
            h1 { font-size: 1.2rem; }
            .btn span { display: none; }
            .header-actions .btn { padding: 6px; }
            .tab span { display: none; }
            .tab { min-width: 50px; }
            .timetable { grid-template-columns: 45px repeat(7, 70px); }
            .matrix-container { grid-template-columns: 1fr; }
            .theme-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-calendar-week"></i></div>
                <h1>Weekly Planner Pro</h1>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="saveToFile()">
                    <i class="fas fa-download"></i><span>Save</span>
                </button>
                <button class="btn btn-secondary" onclick="document.getElementById('loadFile').click()">
                    <i class="fas fa-upload"></i><span>Load</span>
                </button>
                <input type="file" id="loadFile" class="file-input" accept=".json" onchange="loadFromFile(event)">
                <button class="btn btn-secondary" onclick="showClearModal()">
                    <i class="fas fa-trash-alt"></i><span>Clear</span>
                </button>
                <button class="btn btn-icon btn-secondary" onclick="toggleDarkMode()" title="Toggle dark mode">
                    <i class="fas fa-moon" id="darkModeIcon"></i>
                </button>
            </div>
        </header>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('timetable')"><i class="fas fa-calendar-alt"></i><span>Schedule</span></button>
            <button class="tab" onclick="switchTab('habits')"><i class="fas fa-repeat"></i><span>Habits</span></button>
            <button class="tab" onclick="switchTab('matrix')"><i class="fas fa-th-large"></i><span>Matrix</span></button>
            <button class="tab" onclick="switchTab('timer')"><i class="fas fa-clock"></i><span>Timer</span></button>
            <button class="tab" onclick="switchTab('notes')"><i class="fas fa-sticky-note"></i><span>Notes</span></button>
            <button class="tab" onclick="switchTab('themes')"><i class="fas fa-palette"></i><span>Themes</span></button>
        </div>

        <!-- Timetable Tab -->
        <div class="tab-content active" id="tab-timetable">
            <div class="week-nav">
                <div class="nav-btns">
                    <button class="btn btn-secondary btn-icon" onclick="changeWeek(-1)"><i class="fas fa-chevron-left"></i></button>
                </div>
                <h2 id="weekDisplay">Week of Jan 6, 2025</h2>
                <div class="nav-btns">
                    <button class="btn btn-secondary btn-icon" onclick="changeWeek(1)"><i class="fas fa-chevron-right"></i></button>
                    <button class="btn btn-primary btn-sm" onclick="goToToday()">Today</button>
                </div>
            </div>

            <div class="main-grid">
                <div class="timetable-wrapper">
                    <div class="timetable-scroll">
                        <div class="timetable" id="timetable"></div>
                    </div>
                </div>

                <div class="sidebar">
                    <div class="panel">
                        <div class="panel-header">
                            <h3><i class="fas fa-tasks"></i> Tasks</h3>
                            <span id="taskCount">0</span>
                        </div>
                        <div class="panel-body">
                            <div class="task-options">
                                <select id="taskPriority">
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                    <option value="low">Low</option>
                                </select>
                            </div>
                            <div class="task-input-wrapper">
                                <input type="text" class="task-input" id="taskInput" placeholder="Add task..." maxlength="150">
                                <button class="btn btn-primary btn-icon" onclick="addTask()"><i class="fas fa-plus"></i></button>
                            </div>
                            <ul class="task-list" id="taskList"></ul>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <h3><i class="fas fa-bullseye"></i> Weekly Goals</h3>
                        </div>
                        <div class="panel-body">
                            <div class="task-input-wrapper">
                                <input type="text" class="goal-input" id="goalInput" placeholder="Add goal..." maxlength="100">
                                <button class="btn btn-primary btn-icon" onclick="addGoal()"><i class="fas fa-plus"></i></button>
                            </div>
                            <ul class="goal-list" id="goalList"></ul>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-header">
                            <h3><i class="fas fa-chart-pie"></i> Stats</h3>
                            <div class="streak-badge" id="streakBadge" style="display: none;">
                                <i class="fas fa-fire"></i><span id="streakCount">0</span> day streak
                            </div>
                        </div>
                        <div class="panel-body">
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="totalTasks">0</div>
                                    <div class="stat-label">Tasks</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="completedTasks">0</div>
                                    <div class="stat-label">Done</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="filledSlots">0</div>
                                    <div class="stat-label">Slots</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="highPriority">0</div>
                                    <div class="stat-label">Urgent</div>
                                </div>
                            </div>
                            <div class="progress-wrapper">
                                <div class="progress-label">
                                    <span>Progress</span>
                                    <span id="progressPercent">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Habits Tab -->
        <div class="tab-content" id="tab-habits">
            <div class="main-grid">
                <div class="panel" style="grid-column: 1 / -1; max-width: 850px;">
                    <div class="panel-header">
                        <h3><i class="fas fa-repeat"></i> Daily Habits</h3>
                        <button class="btn btn-primary btn-sm" onclick="toggleAddHabit()"><i class="fas fa-plus"></i> Add</button>
                    </div>
                    <div class="panel-body">
                        <div class="add-habit-form" id="addHabitForm" style="display: none;">
                            <div class="add-habit-row">
                                <input type="text" id="habitName" placeholder="Habit name..." maxlength="40">
                                <select id="habitIcon">
                                    <option value="study">üìö Study</option>
                                    <option value="exercise">üèÉ Exercise</option>
                                    <option value="homework">üìù Homework</option>
                                    <option value="leisure">üéÆ Leisure</option>
                                    <option value="custom">‚≠ê Custom</option>
                                </select>
                            </div>
                            <div class="add-habit-row">
                                <select id="habitType">
                                    <option value="work">Work/Learning</option>
                                    <option value="play">Play/Leisure</option>
                                </select>
                                <button class="btn btn-primary" onclick="addHabit()">Add Habit</button>
                            </div>
                        </div>
                        <div class="habits-grid" id="habitsGrid"></div>
                        <div class="balance-section">
                            <div class="balance-title">üìä Work / Play Balance</div>
                            <div class="balance-labels">
                                <span class="work"><i class="fas fa-briefcase"></i> <span id="workPercent">0%</span></span>
                                <span class="play"><i class="fas fa-gamepad"></i> <span id="playPercent">0%</span></span>
                            </div>
                            <div class="balance-bar">
                                <div class="balance-work" id="balanceWork" style="width: 0%"></div>
                                <div class="balance-neutral"></div>
                                <div class="balance-play" id="balancePlay" style="width: 0%"></div>
                            </div>
                            <div class="balance-message" id="balanceMessage">Add habits to track balance!</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Matrix Tab -->
        <div class="tab-content" id="tab-matrix">
            <div class="matrix-container">
                <div class="matrix-labels">
                    <div class="matrix-label"><i class="fas fa-arrow-up"></i> Important</div>
                    <div class="matrix-label"><i class="fas fa-arrow-right"></i> Urgent</div>
                </div>
                <div class="matrix-quadrant q1">
                    <div class="quadrant-header"><i class="fas fa-fire"></i> Do First</div>
                    <div class="quadrant-body">
                        <div class="quadrant-input-wrapper">
                            <input type="text" class="quadrant-input" placeholder="Add..." data-quadrant="q1" maxlength="80">
                            <button class="btn btn-icon btn-sm btn-primary" onclick="addMatrixItem('q1')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="quadrant-items" id="q1-items"></div>
                    </div>
                </div>
                <div class="matrix-quadrant q2">
                    <div class="quadrant-header"><i class="fas fa-calendar-check"></i> Schedule</div>
                    <div class="quadrant-body">
                        <div class="quadrant-input-wrapper">
                            <input type="text" class="quadrant-input" placeholder="Add..." data-quadrant="q2" maxlength="80">
                            <button class="btn btn-icon btn-sm btn-primary" onclick="addMatrixItem('q2')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="quadrant-items" id="q2-items"></div>
                    </div>
                </div>
                <div class="matrix-quadrant q3">
                    <div class="quadrant-header"><i class="fas fa-user-friends"></i> Delegate</div>
                    <div class="quadrant-body">
                        <div class="quadrant-input-wrapper">
                            <input type="text" class="quadrant-input" placeholder="Add..." data-quadrant="q3" maxlength="80">
                            <button class="btn btn-icon btn-sm btn-primary" onclick="addMatrixItem('q3')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="quadrant-items" id="q3-items"></div>
                    </div>
                </div>
                <div class="matrix-quadrant q4">
                    <div class="quadrant-header"><i class="fas fa-trash-alt"></i> Eliminate</div>
                    <div class="quadrant-body">
                        <div class="quadrant-input-wrapper">
                            <input type="text" class="quadrant-input" placeholder="Add..." data-quadrant="q4" maxlength="80">
                            <button class="btn btn-icon btn-sm btn-primary" onclick="addMatrixItem('q4')"><i class="fas fa-plus"></i></button>
                        </div>
                        <div class="quadrant-items" id="q4-items"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timer Tab -->
        <div class="tab-content" id="tab-timer">
            <div class="main-grid">
                <div class="panel" style="max-width: 400px; margin: 0 auto;">
                    <div class="panel-header">
                        <h3><i class="fas fa-clock"></i> Pomodoro Timer</h3>
                    </div>
                    <div class="pomodoro-container">
                        <div class="pomodoro-display" id="timerDisplay">25:00</div>
                        <div class="pomodoro-label" id="timerLabel">Focus Time</div>
                        <div class="pomodoro-controls">
                            <button class="btn btn-primary" id="timerStartBtn" onclick="toggleTimer()">
                                <i class="fas fa-play"></i> Start
                            </button>
                            <button class="btn btn-secondary" onclick="resetTimer()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                        <div class="pomodoro-presets">
                            <button class="preset-btn active" onclick="setTimerPreset(25, 'Focus')">25 min</button>
                            <button class="preset-btn" onclick="setTimerPreset(50, 'Deep Work')">50 min</button>
                            <button class="preset-btn" onclick="setTimerPreset(5, 'Short Break')">5 min</button>
                            <button class="preset-btn" onclick="setTimerPreset(15, 'Long Break')">15 min</button>
                        </div>
                    </div>
                </div>

                <div class="panel" style="max-width: 400px; margin: 20px auto 0;">
                    <div class="panel-header">
                        <h3><i class="fas fa-quote-left"></i> Inspiration</h3>
                    </div>
                    <div class="panel-body">
                        <div class="quote-card">
                            <div class="quote-text" id="quoteText">"The secret of getting ahead is getting started."</div>
                            <div class="quote-author" id="quoteAuthor">‚Äî Mark Twain</div>
                        </div>
                        <div class="quote-refresh">
                            <button class="btn btn-secondary btn-sm" onclick="newQuote()">
                                <i class="fas fa-sync-alt"></i> New Quote
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notes Tab -->
        <div class="tab-content" id="tab-notes">
            <div class="main-grid">
                <div class="panel" style="grid-column: 1 / -1; max-width: 800px;">
                    <div class="panel-header">
                        <h3><i class="fas fa-sticky-note"></i> Quick Notes</h3>
                        <span style="font-size: 11px; color: var(--text-muted);">Auto-saved</span>
                    </div>
                    <div class="panel-body">
                        <textarea class="notes-area" id="notesArea" placeholder="Write your notes here... Ideas, reminders, anything!"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- Themes Tab -->
        <div class="tab-content" id="tab-themes">
            <div class="main-grid">
                <div class="panel" style="grid-column: 1 / -1; max-width: 700px;">
                    <div class="panel-header">
                        <h3><i class="fas fa-palette"></i> Theme Gallery</h3>
                    </div>
                    <div class="panel-body">
                        <div class="theme-grid" id="themeGrid">
                            <div class="theme-card active" onclick="setTheme('')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #c9a227, #faf9f7);"></div>
                                <div class="theme-name">Classic Gold</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('cyberpunk')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #ff00ff, #00fff9, #0a0a12);"></div>
                                <div class="theme-name">Cyberpunk</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('90s')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #ffeb3b, #ff5722, #e91e63);"></div>
                                <div class="theme-name">90s Retro</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('vintage')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #8b4513, #f4e4bc);"></div>
                                <div class="theme-name">Vintage Paper</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('neon')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #39ff14, #0d0d0d);"></div>
                                <div class="theme-name">Neon Night</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('ocean')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #00838f, #e0f7fa);"></div>
                                <div class="theme-name">Ocean Depths</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('sunset')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #ff6b6b, #fff5f5);"></div>
                                <div class="theme-name">Sunset</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('forest')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #4caf50, #f1f8e9);"></div>
                                <div class="theme-name">Forest</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('lavender')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #9c27b0, #f3e5f5);"></div>
                                <div class="theme-name">Lavender</div>
                            </div>
                            <div class="theme-card" onclick="setTheme('minimal')">
                                <div class="theme-preview" style="background: linear-gradient(135deg, #111111, #fafafa);"></div>
                                <div class="theme-name">Minimal</div>
                            </div>
                        </div>

                        <div class="color-mixer">
                            <div class="color-mixer-title">üé® Custom Color Mixer</div>
                            <div class="color-row">
                                <label>Accent Color</label>
                                <input type="color" class="color-picker" id="accentPicker" value="#c9a227" onchange="updateCustomAccent()">
                                <input type="range" class="intensity-slider" id="intensitySlider" min="50" max="150" value="100" onchange="updateCustomAccent()">
                            </div>
                            <div class="color-row">
                                <label>Intensity</label>
                                <span id="intensityValue" style="font-size: 12px;">100%</span>
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="applyCustomColor()">
                                <i class="fas fa-check"></i> Apply Color
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slot Editor Modal -->
    <div class="slot-editor-modal" id="slotEditorModal">
        <div class="slot-editor">
            <div class="slot-editor-header">
                <div>
                    <h3>Edit Time Slot</h3>
                    <div class="slot-editor-info">
                        <span id="slotDay">Monday</span>
                        <span id="slotTime">09:00</span>
                    </div>
                </div>
                <button class="task-btn" onclick="closeSlotEditor()"><i class="fas fa-times"></i></button>
            </div>
            <div class="slot-editor-body">
                <textarea id="slotEditorText" placeholder="What's planned for this time?"></textarea>
            </div>
            <div class="slot-editor-footer">
                <button class="btn btn-secondary" onclick="closeSlotEditor()">Cancel</button>
                <button class="btn btn-primary" onclick="saveSlotEdit()"><i class="fas fa-check"></i> Save</button>
            </div>
        </div>
    </div>

    <!-- Clear Modal -->
    <div class="modal-overlay" id="clearModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Clear All Data?</h3>
                <button class="task-btn" onclick="closeClearModal()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p>This will delete all tasks, habits, notes, and timetable data. This cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeClearModal()">Cancel</button>
                <button class="btn btn-primary" style="background: var(--danger);" onclick="clearAllData()">Clear All</button>
            </div>
        </div>
    </div>

    <!-- FAB -->
    <button class="fab" onclick="toggleFab()" id="fab"><i class="fas fa-plus"></i></button>
    <div class="fab-menu" id="fabMenu">
        <div class="fab-item" onclick="quickAddTask()"><i class="fas fa-tasks"></i> Quick Task</div>
        <div class="fab-item" onclick="quickAddGoal()"><i class="fas fa-bullseye"></i> Quick Goal</div>
        <div class="fab-item" onclick="switchTab('timer'); toggleFab();"><i class="fas fa-clock"></i> Start Timer</div>
    </div>

    <script>
        // ========== STATE ==========
        let currentWeekStart = getMonday(new Date());
        let timetableData = {};
        let tasks = [];
        let taskIdCounter = 1;
        let goals = [];
        let goalIdCounter = 1;
        let habits = [];
        let habitIdCounter = 1;
        let matrixItems = { q1: [], q2: [], q3: [], q4: [] };
        let matrixIdCounter = 1;
        let notes = '';
        let currentTheme = '';
        let currentSlotKey = null;
        let currentSlotWeek = null;
        let timerInterval = null;
        let timerSeconds = 25 * 60;
        let timerRunning = false;
        let timerLabel = 'Focus Time';
        let streak = 0;

        const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
        const fullDays = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
        const timeSlots = [];
        for (let h = 6; h <= 22; h++) timeSlots.push(`${h.toString().padStart(2, '0')}:00`);

        const quotes = [
            { text: "The secret of getting ahead is getting started.", author: "Mark Twain" },
            { text: "It always seems impossible until it's done.", author: "Nelson Mandela" },
            { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
            { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { text: "Success is not final, failure is not fatal.", author: "Winston Churchill" },
            { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
            { text: "Your time is limited, don't waste it living someone else's life.", author: "Steve Jobs" },
            { text: "The future depends on what you do today.", author: "Mahatma Gandhi" },
            { text: "Hard work beats talent when talent doesn't work hard.", author: "Tim Notke" },
            { text: "Dream big and dare to fail.", author: "Norman Vaughan" }
        ];

        // ========== INIT ==========
        function init() {
            initTheme();
            renderTimetable();
            updateWeekDisplay();
            renderTasks();
            renderGoals();
            renderHabits();
            renderMatrix();
            updateStats();
            updateBalance();
            setupEventListeners();
            newQuote();
        }

        function setupEventListeners() {
            document.getElementById('taskInput').addEventListener('keypress', e => { if (e.key === 'Enter') addTask(); });
            document.getElementById('goalInput').addEventListener('keypress', e => { if (e.key === 'Enter') addGoal(); });
            document.getElementById('habitName').addEventListener('keypress', e => { if (e.key === 'Enter') addHabit(); });
            document.querySelectorAll('.quadrant-input').forEach(input => {
                input.addEventListener('keypress', e => { if (e.key === 'Enter') addMatrixItem(e.target.dataset.quadrant); });
            });
            document.getElementById('notesArea').addEventListener('input', e => { notes = e.target.value; });
            document.getElementById('intensitySlider').addEventListener('input', e => {
                document.getElementById('intensityValue').textContent = e.target.value + '%';
            });
        }

        // ========== THEME ==========
        function initTheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
                document.documentElement.classList.toggle('dark', e.matches);
                updateDarkModeUI();
            });
            updateDarkModeUI();
        }

        function setTheme(theme) {
            const isDark = document.documentElement.classList.contains('dark');
            document.documentElement.className = isDark ? 'dark' : '';
            if (theme) document.documentElement.classList.add(`theme-${theme}`);
            currentTheme = theme;
            document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('active'));
            if (event && event.target) event.target.closest('.theme-card').classList.add('active');
        }

        function toggleDarkMode() {
            document.documentElement.classList.toggle('dark');
            updateDarkModeUI();
        }

        function updateDarkModeUI() {
            const isDark = document.documentElement.classList.contains('dark');
            document.getElementById('darkModeIcon').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
        }

        function updateCustomAccent() {
            const color = document.getElementById('accentPicker').value;
            const intensity = document.getElementById('intensitySlider').value;
            document.getElementById('intensityValue').textContent = intensity + '%';
        }

        function applyCustomColor() {
            const color = document.getElementById('accentPicker').value;
            const r = parseInt(color.slice(1,3), 16);
            const g = parseInt(color.slice(3,5), 16);
            const b = parseInt(color.slice(5,7), 16);
            document.documentElement.style.setProperty('--accent', color);
            document.documentElement.style.setProperty('--accent-rgb', `${r}, ${g}, ${b}`);
            document.documentElement.style.setProperty('--accent-light', `rgba(${r}, ${g}, ${b}, 0.15)`);
            document.documentElement.style.setProperty('--accent-hover', color);
        }

        // ========== TABS ==========
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelector(`.tab:nth-child(${['timetable','habits','matrix','timer','notes','themes'].indexOf(tabId)+1})`).classList.add('active');
            document.getElementById(`tab-${tabId}`).classList.add('active');
        }

        // ========== DATE ==========
        function getMonday(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day + (day === 0 ? -6 : 1);
            return new Date(d.setDate(diff));
        }

        function formatDate(date) {
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function getWeekKey() { return currentWeekStart.toISOString().split('T')[0]; }
        function updateWeekDisplay() { document.getElementById('weekDisplay').textContent = `Week of ${formatDate(currentWeekStart)}`; renderTimetable(); }
        function changeWeek(delta) { currentWeekStart.setDate(currentWeekStart.getDate() + (delta * 7)); updateWeekDisplay(); }
        function goToToday() { currentWeekStart = getMonday(new Date()); updateWeekDisplay(); }

        // ========== TIMETABLE ==========
        function renderTimetable() {
            const timetable = document.getElementById('timetable');
            const today = new Date();
            const todayIndex = (today.getDay() + 6) % 7;
            const weekKey = getWeekKey();
            const isCurrentWeek = currentWeekStart.toDateString() === getMonday(today).toDateString();
            if (!timetableData[weekKey]) timetableData[weekKey] = {};

            let html = '<div class="day-header" style="font-size: 9px;">Time</div>';
            days.forEach((day, i) => {
                const isToday = i === todayIndex && isCurrentWeek;
                const dateOfDay = new Date(currentWeekStart);
                dateOfDay.setDate(dateOfDay.getDate() + i);
                html += `<div class="day-header ${isToday ? 'today' : ''}">${day}<span class="day-date">${dateOfDay.getDate()}</span></div>`;
            });

            timeSlots.forEach(time => {
                html += `<div class="time-slot">${time}</div>`;
                days.forEach((day, i) => {
                    const key = `${day}-${time}`;
                    const value = timetableData[weekKey][key] || '';
                    const hasContent = value.trim() !== '';
                    html += `<div class="slot-cell ${hasContent ? 'has-content' : ''}" onclick="openSlotEditor('${key}', '${weekKey}', '${fullDays[i]}', '${time}')">
                        ${hasContent ? `<div class="slot-text">${escapeHtml(value)}</div>` : ''}
                        <div class="edit-hint"><i class="fas fa-plus"></i></div>
                    </div>`;
                });
            });
            timetable.innerHTML = html;
        }

        function openSlotEditor(key, weekKey, day, time) {
            currentSlotKey = key; currentSlotWeek = weekKey;
            document.getElementById('slotDay').textContent = day;
            document.getElementById('slotTime').textContent = time;
            document.getElementById('slotEditorText').value = (timetableData[weekKey] && timetableData[weekKey][key]) || '';
            document.getElementById('slotEditorModal').classList.add('active');
            setTimeout(() => document.getElementById('slotEditorText').focus(), 100);
        }

        function closeSlotEditor() { document.getElementById('slotEditorModal').classList.remove('active'); }

        function saveSlotEdit() {
            if (!currentSlotKey || !currentSlotWeek) return;
            if (!timetableData[currentSlotWeek]) timetableData[currentSlotWeek] = {};
            timetableData[currentSlotWeek][currentSlotKey] = document.getElementById('slotEditorText').value;
            renderTimetable(); updateStats(); closeSlotEditor();
        }

        // ========== TASKS ==========
        function addTask() {
            const input = document.getElementById('taskInput');
            const text = input.value.trim();
            if (!text) return;
            tasks.push({ id: taskIdCounter++, text, priority: document.getElementById('taskPriority').value, completed: false });
            input.value = ''; renderTasks(); updateStats();
        }

        function renderTasks() {
            const list = document.getElementById('taskList');
            if (tasks.length === 0) { list.innerHTML = '<div class="empty-state"><i class="fas fa-clipboard-list"></i><p>No tasks yet</p></div>'; return; }
            list.innerHTML = tasks.map((t, i) => `
                <li class="task-item ${t.completed ? 'completed' : ''}">
                    <div class="task-number">${i + 1}</div>
                    <div class="task-content">
                        <div class="task-text">${escapeHtml(t.text)}</div>
                        <div class="task-meta"><span class="task-badge priority-${t.priority}">${t.priority}</span></div>
                    </div>
                    <div class="task-actions">
                        <button class="task-btn complete" onclick="toggleTask(${t.id})"><i class="fas ${t.completed ? 'fa-undo' : 'fa-check'}"></i></button>
                        <button class="task-btn delete" onclick="deleteTask(${t.id})"><i class="fas fa-times"></i></button>
                    </div>
                </li>
            `).join('');
        }

        function toggleTask(id) { const t = tasks.find(x => x.id === id); if (t) { t.completed = !t.completed; renderTasks(); updateStats(); } }
        function deleteTask(id) { tasks = tasks.filter(t => t.id !== id); renderTasks(); updateStats(); }

        // ========== GOALS ==========
        function addGoal() {
            const input = document.getElementById('goalInput');
            const text = input.value.trim();
            if (!text) return;
            goals.push({ id: goalIdCounter++, text, completed: false });
            input.value = ''; renderGoals();
        }

        function renderGoals() {
            const list = document.getElementById('goalList');
            if (goals.length === 0) { list.innerHTML = '<div class="empty-state"><i class="fas fa-bullseye"></i><p>Set your weekly goals</p></div>'; return; }
            list.innerHTML = goals.map(g => `
                <li class="goal-item ${g.completed ? 'completed' : ''}">
                    <div class="goal-content"><div class="goal-text">${escapeHtml(g.text)}</div></div>
                    <div class="goal-actions">
                        <button class="task-btn complete" onclick="toggleGoal(${g.id})"><i class="fas ${g.completed ? 'fa-undo' : 'fa-check'}"></i></button>
                        <button class="task-btn delete" onclick="deleteGoal(${g.id})"><i class="fas fa-times"></i></button>
                    </div>
                </li>
            `).join('');
        }

        function toggleGoal(id) { const g = goals.find(x => x.id === id); if (g) { g.completed = !g.completed; renderGoals(); } }
        function deleteGoal(id) { goals = goals.filter(g => g.id !== id); renderGoals(); }

        // ========== HABITS ==========
        function toggleAddHabit() { const f = document.getElementById('addHabitForm'); f.style.display = f.style.display === 'none' ? 'flex' : 'none'; }

        function addHabit() {
            const name = document.getElementById('habitName').value.trim();
            if (!name) return;
            habits.push({ id: habitIdCounter++, name, icon: document.getElementById('habitIcon').value, type: document.getElementById('habitType').value, days: [false,false,false,false,false,false,false] });
            document.getElementById('habitName').value = '';
            document.getElementById('addHabitForm').style.display = 'none';
            renderHabits(); updateBalance();
        }

        function renderHabits() {
            const grid = document.getElementById('habitsGrid');
            if (habits.length === 0) { grid.innerHTML = '<div class="empty-state"><i class="fas fa-repeat"></i><p>Add daily habits</p></div>'; return; }
            const icons = { study: '<i class="fas fa-book"></i>', exercise: '<i class="fas fa-dumbbell"></i>', homework: '<i class="fas fa-pencil-alt"></i>', leisure: '<i class="fas fa-gamepad"></i>', custom: '<i class="fas fa-star"></i>' };
            grid.innerHTML = habits.map(h => `
                <div class="habit-row">
                    <div class="habit-icon ${h.icon}">${icons[h.icon]}</div>
                    <div class="habit-info"><div class="habit-name">${escapeHtml(h.name)}</div><div class="habit-target">${h.type === 'work' ? 'üìö Work' : 'üéÆ Play'}</div></div>
                    <div class="habit-days">${days.map((d, i) => `<button class="habit-day ${h.days[i] ? 'done' : ''}" onclick="toggleHabitDay(${h.id}, ${i})">${d[0]}</button>`).join('')}</div>
                    <button class="task-btn delete" onclick="deleteHabit(${h.id})"><i class="fas fa-times"></i></button>
                </div>
            `).join('');
        }

        function toggleHabitDay(id, day) { const h = habits.find(x => x.id === id); if (h) { h.days[day] = !h.days[day]; renderHabits(); updateBalance(); } }
        function deleteHabit(id) { habits = habits.filter(h => h.id !== id); renderHabits(); updateBalance(); }

        function updateBalance() {
            let work = 0, play = 0;
            habits.forEach(h => { const c = h.days.filter(d => d).length; if (h.type === 'work') work += c; else play += c; });
            const total = work + play;
            const wp = total > 0 ? Math.round((work / total) * 100) : 0;
            const pp = total > 0 ? Math.round((play / total) * 100) : 0;
            document.getElementById('workPercent').textContent = wp + '%';
            document.getElementById('playPercent').textContent = pp + '%';
            document.getElementById('balanceWork').style.width = (wp / 2) + '%';
            document.getElementById('balancePlay').style.width = (pp / 2) + '%';
            let msg = 'Add habits to track!';
            if (total > 0) { const d = wp - pp; msg = Math.abs(d) <= 20 ? '‚öñÔ∏è Great balance!' : d > 20 ? 'üìö Work focused!' : 'üéÆ Play time!'; }
            document.getElementById('balanceMessage').textContent = msg;
        }

        // ========== MATRIX ==========
        function addMatrixItem(q) {
            const input = document.querySelector(`.quadrant-input[data-quadrant="${q}"]`);
            const text = input.value.trim();
            if (!text) return;
            matrixItems[q].push({ id: matrixIdCounter++, text, completed: false });
            input.value = ''; renderMatrix();
        }

        function renderMatrix() {
            ['q1','q2','q3','q4'].forEach(q => {
                document.getElementById(`${q}-items`).innerHTML = matrixItems[q].map(item => `
                    <div class="quadrant-item ${item.completed ? 'completed' : ''}">
                        <span class="item-text">${escapeHtml(item.text)}</span>
                        <button class="task-btn complete" onclick="toggleMatrixItem('${q}', ${item.id})"><i class="fas ${item.completed ? 'fa-undo' : 'fa-check'}"></i></button>
                        <button class="task-btn delete" onclick="deleteMatrixItem('${q}', ${item.id})"><i class="fas fa-times"></i></button>
                    </div>
                `).join('');
            });
        }

        function toggleMatrixItem(q, id) { const i = matrixItems[q].find(x => x.id === id); if (i) { i.completed = !i.completed; renderMatrix(); } }
        function deleteMatrixItem(q, id) { matrixItems[q] = matrixItems[q].filter(i => i.id !== id); renderMatrix(); }

        // ========== STATS ==========
        function updateStats() {
            const total = tasks.length, done = tasks.filter(t => t.completed).length, high = tasks.filter(t => t.priority === 'high' && !t.completed).length;
            let slots = 0;
            Object.values(timetableData).forEach(w => Object.values(w).forEach(v => { if (v && v.trim()) slots++; }));
            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = done;
            document.getElementById('filledSlots').textContent = slots;
            document.getElementById('highPriority').textContent = high;
            document.getElementById('taskCount').textContent = total;
            const pct = total > 0 ? Math.round((done / total) * 100) : 0;
            document.getElementById('progressPercent').textContent = pct + '%';
            document.getElementById('progressFill').style.width = pct + '%';
            if (done > 0) { document.getElementById('streakBadge').style.display = 'inline-flex'; document.getElementById('streakCount').textContent = done; }
        }

        // ========== TIMER ==========
        function updateTimerDisplay() {
            const m = Math.floor(timerSeconds / 60), s = timerSeconds % 60;
            document.getElementById('timerDisplay').textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function toggleTimer() {
            if (timerRunning) {
                clearInterval(timerInterval); timerRunning = false;
                document.getElementById('timerStartBtn').innerHTML = '<i class="fas fa-play"></i> Start';
            } else {
                timerRunning = true;
                document.getElementById('timerStartBtn').innerHTML = '<i class="fas fa-pause"></i> Pause';
                timerInterval = setInterval(() => {
                    if (timerSeconds > 0) { timerSeconds--; updateTimerDisplay(); }
                    else { clearInterval(timerInterval); timerRunning = false; document.getElementById('timerStartBtn').innerHTML = '<i class="fas fa-play"></i> Start'; }
                }, 1000);
            }
        }

        function resetTimer() {
            clearInterval(timerInterval); timerRunning = false;
            document.getElementById('timerStartBtn').innerHTML = '<i class="fas fa-play"></i> Start';
            timerSeconds = 25 * 60; updateTimerDisplay();
        }

        function setTimerPreset(mins, label) {
            clearInterval(timerInterval); timerRunning = false;
            document.getElementById('timerStartBtn').innerHTML = '<i class="fas fa-play"></i> Start';
            timerSeconds = mins * 60; timerLabel = label;
            document.getElementById('timerLabel').textContent = label;
            updateTimerDisplay();
            document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
            if (event) event.target.classList.add('active');
        }

        function newQuote() {
            const q = quotes[Math.floor(Math.random() * quotes.length)];
            document.getElementById('quoteText').textContent = `"${q.text}"`;
            document.getElementById('quoteAuthor').textContent = `‚Äî ${q.author}`;
        }

        // ========== FAB ==========
        function toggleFab() {
            document.getElementById('fabMenu').classList.toggle('active');
            document.getElementById('fab').innerHTML = document.getElementById('fabMenu').classList.contains('active') ? '<i class="fas fa-times"></i>' : '<i class="fas fa-plus"></i>';
        }

        function quickAddTask() { toggleFab(); switchTab('timetable'); document.getElementById('taskInput').focus(); }
        function quickAddGoal() { toggleFab(); switchTab('timetable'); document.getElementById('goalInput').focus(); }

        // ========== SAVE/LOAD ==========
        function saveToFile() {
            const data = { version: 3, timetable: timetableData, tasks, taskIdCounter, goals, goalIdCounter, habits, habitIdCounter, matrixItems, matrixIdCounter, notes: document.getElementById('notesArea').value, theme: currentTheme };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
            a.download = `planner-${new Date().toISOString().split('T')[0]}.json`;
            a.click(); URL.revokeObjectURL(a.href);
        }

        function loadFromFile(event) {
            const file = event.target.files[0]; if (!file) return;
            const reader = new FileReader();
            reader.onload = e => {
                try {
                    const d = JSON.parse(e.target.result);
                    if (d.timetable) timetableData = d.timetable;
                    if (d.tasks) tasks = d.tasks;
                    if (d.taskIdCounter) taskIdCounter = d.taskIdCounter;
                    if (d.goals) goals = d.goals;
                    if (d.goalIdCounter) goalIdCounter = d.goalIdCounter;
                    if (d.habits) habits = d.habits;
                    if (d.habitIdCounter) habitIdCounter = d.habitIdCounter;
                    if (d.matrixItems) matrixItems = d.matrixItems;
                    if (d.matrixIdCounter) matrixIdCounter = d.matrixIdCounter;
                    if (d.notes) document.getElementById('notesArea').value = d.notes;
                    if (d.theme) setTheme(d.theme);
                    renderTimetable(); renderTasks(); renderGoals(); renderHabits(); renderMatrix(); updateStats(); updateBalance();
                } catch (err) { console.error('Load error:', JSON.stringify(err)); }
            };
            reader.readAsText(file); event.target.value = '';
        }

        function showClearModal() { document.getElementById('clearModal').classList.add('active'); }
        function closeClearModal() { document.getElementById('clearModal').classList.remove('active'); }

        function clearAllData() {
            timetableData = {}; tasks = []; taskIdCounter = 1; goals = []; goalIdCounter = 1;
            habits = []; habitIdCounter = 1; matrixItems = { q1: [], q2: [], q3: [], q4: [] }; matrixIdCounter = 1;
            document.getElementById('notesArea').value = '';
            renderTimetable(); renderTasks(); renderGoals(); renderHabits(); renderMatrix(); updateStats(); updateBalance();
            closeClearModal();
        }

        function escapeHtml(text) { const d = document.createElement('div'); d.textContent = text; return d.innerHTML; }

        init();
    </script>
</body>
</html>
